(()=>{"use strict";const e=document.querySelector(".add-task"),t=document.querySelector(".modal"),a=document.querySelector(".overlay");function r(){t.classList.remove("show"),a.classList.remove("show")}const o=document.querySelector("[data-projects]"),d=document.querySelector("[data-new-project-form]"),s=document.querySelector("[data-new-project-input]"),n=document.querySelector("[data-delete-project-btn]"),c=document.querySelector("[data-form-title]"),l=document.querySelector("[data-form-description]"),i=document.querySelector("[data-form-due-date]"),u=document.querySelector("[data-form-priority]"),m=document.querySelector(".title-msg"),v=document.querySelector("[data-project-display-container]"),f=document.querySelector("[data-project-title]"),k=document.querySelector("[data-tasks]"),p=document.getElementById("input-todo"),y=document.getElementById("cancel"),S=document.getElementById("task-template"),L="task.projects",g="task.selectedProjectId";let q=(L,JSON.parse(localStorage.getItem("task.projects"))||[]);let I=(g,localStorage.getItem("task.selectedProjectId"));function h(){var e,t;t=q,localStorage.setItem("task.projects",JSON.stringify(t)),e=I,localStorage.setItem("task.selectedProjectId",e),j()}function j(){E(o),q.forEach((e=>{const t=document.createElement("li");t.dataset.projID=e.id,t.classList.add("project-name"),t.innerText=e.name,e.id===I&&t.classList.add("active-project"),o.appendChild(t)}));const e=q.find((e=>e.id===I));null==I||"null"==I?v.classList.add("hide"):(v.classList.remove("hide"),f.innerText=e.name,E(k),function(e){e.tasks.forEach((e=>{const t=document.importNode(S.content,!0),a=t.querySelector("div"),r=t.querySelector(".task-title"),o=t.querySelector(".task-dueDate"),d=t.querySelector(".edit-task"),s=t.querySelector(".delete-task");a.dataset.taskID=e.id,d.dataset.taskID=e.id,s.dataset.taskID=e.id,r.innerText=e.title,o.innerText=e.dueDate,k.appendChild(t)}))}(e))}function E(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function D(){c.value="",l.value="",i.value="",u.value="low",c.classList.remove("error"),m.innerHTML=""}o.addEventListener("click",(e=>{"li"===e.target.tagName.toLowerCase()&&(I=e.target.dataset.projID,h())})),k.addEventListener("click",(e=>{if("div"===e.target.tagName.toLowerCase()){const t=e.target.dataset.taskID,a=q.find((e=>e.id===I)).tasks.find((e=>e.id===t));console.log(a)}if("delete-task fa fa-trash"===e.target.className.toLowerCase()){const t=e.target.dataset.taskID,a=q.find((e=>e.id===I));a.tasks=a.tasks.filter((e=>e.id!==t)),h()}})),d.addEventListener("submit",(e=>{e.preventDefault();const t=s.value;if(null==t||""===t)return;const a=(r=t,{id:Date.now().toString(),name:r,tasks:[]});var r;q.push(a),s.value=null,h()})),n.addEventListener("click",(e=>{q=q.filter((e=>e.id!==I)),I=null,h()})),y.addEventListener("click",(e=>{r(),D()})),p.addEventListener("submit",(e=>{if(e.preventDefault(),null==c.value||""===c.value)return c.classList.add("error"),void(m.innerHTML="Please include a title");const t=(a=c.value,o=l.value,d=i.value,s=u.value,{id:Date.now().toString(),title:a,description:o,dueDate:d,priority:s});var a,o,d,s;q.find((e=>e.id===I)).tasks.push(t),h(),r(),D()})),c.addEventListener("keydown",(e=>{""!==c.value&&(c.classList.remove("error"),m.innerHTML="")})),e.addEventListener("click",(e=>{t.classList.add("show"),a.classList.add("show")})),a.addEventListener("click",(e=>{r()})),j()})();